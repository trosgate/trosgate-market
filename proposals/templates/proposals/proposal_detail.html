{% extends "dashboard/main_base.html" %}

{% load static %}

{% block content %}

			<!--Inner Home Banner Start-->
			<div class="wt-haslayout wt-innerbannerholder">
				<div class="container">
					<div class="row justify-content-md-center">
						<div class="col-xs-12 col-sm-12 col-md-8 push-md-2 col-lg-6 push-lg-3">
							<div class="wt-innerbannercontent">
							<div class="wt-title"><h2>Proposal Detail</h2></div>
								{% if request.user.is_authenticated %}
								<ol class="wt-breadcrumb">
									<li><a href="{% url 'account:dashboard' %}" class="btn btn-primary btn-sm"><i class="fa fa-pencil-square-o"></i> Dashboard</a></li>
									{% if active_team.pk == request.user.freelancer.active_team_id and proposal.status == 'active' %}
									<li><a href="{% url 'proposals:modify_proposal_step_one' proposal.id proposal.slug %}" class="btn btn-warning btn-sm"><i class="fa fa-pencil-square-o"></i> Modify</a></li>
									<li><a href="{% url 'proposals:archive_proposal' proposal.created_by.short_name proposal.slug %}" class="btn btn-danger btn-sm"><i class="fa fa-trash"></i> Archive</a></li>
									{% elif active_team.pk == request.user.freelancer.active_team_id and proposal.status == 'review' %}
									<li><a href="javascript:void(0);" class="btn btn-success btn-sm"><i class="fas fa-spinner fa-spin"></i> Reviewing</a></li>
									{% elif active_team.pk == request.user.freelancer.active_team_id and proposal.status == 'archived' %}
									<li><a href="{% url 'proposals:reactivate_archive_proposal' proposal.created_by.short_name proposal.slug %}" class="btn btn-info btn-sm"><i class="fa fa-window-restore"></i> Restore</a></li>
									{% elif active_team.pk == request.user.freelancer.active_team_id and proposal.status == 'modify' %}
									<li><a href="{% url 'proposals:modify_proposal_step_one' proposal.id proposal.slug %}" class="btn btn-warning btn-sm"><i class="fa fa-pencil-square-o"></i> Modify</a></li>
									{% endif %}
								</ol>
								{% endif %}
							</div>
						</div>
					</div>
				</div>
			</div>
			
			<!--Inner Home End-->
			<!--Main Start-->
			<main class="wt-haslayout wt-innerbgcolor">
				<div class="wt-haslayout wt-main-section">
					<!-- User Listing Start-->
					<div class="container">
						<div class="row">
							<div id="wt-twocolumns" class="wt-twocolumns wt-haslayout">
								<div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12 float-left">
								<div class="wt-proposalholder">
									<div class="wt-proposalhead">
										<h2>{{proposal.title}}</h2>
										<ul class="wt-userlisting-breadcrumb wt-userlisting-breadcrumbvtwo">
											<li><span><i class="far fa-money-bill-alt" style="color:green;"></i> {{base_currency}} {{proposal.salary}}</span></li>
											<li><span><i class="fa fa-arrow-up" style="color:red;"></i> Sales: {{overal_proposal_sales_count}}</span></li>
											<li><span>{% if proposal.created_by.country.flag %}<img src="{{proposal.created_by.country.flag.url}}" alt="img description"> {% else %}{{proposal.created_by.country.country_code}} - {% endif %} {{proposal.created_by.country.name}}</span></li>
											<li><span><i class="far fa-clock" style="color:blue;"></i> Duration: {{proposal.get_dura_converter_display }}</span></li>
											{% if request.user.clients %}
											<li><span><button class="btn btn-success btn-sm text-white"  data-toggle="modal" data-target="#oneClickProposalCheckout">1-Click Purchase</button></span></li>
											{% endif %}
										</ul>
									</div>
									{% if request.user.is_authenticated and request.user.clients %}
									<div class="wt-btnarea"><a href="{% url 'transactions:hiring_summary' proposal.created_by.short_name proposal.slug %}" class="wt-btn">Hire Expert</a></div>
									{% elif request.user.is_authenticated and request.user.freelancer %}
									<div class="wt-btnarea"><button class="wt-btn"><strike style="color:white">... Hire Expert ...</strike></button></div>
									{% elif not request.user.is_authenticated %}
									<div class="wt-btnarea"><a href="{% url 'account:login' %}" class="wt-btn">Hire Expert</a></div>
									{% endif %}
								</div>
								</div>
								<div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12 float-left">
									<figure class="wt-companysimg">
										<img src="{% firstof proposal.thumbnail.url proposal.created_by.freelancer.banner_photo.url %}" style="width:1920px;" alt="img description">
									</figure>
								</div>
								
								<div class="col-xs-12 col-sm-12 col-md-7 col-lg-7 col-xl-8 float-left">
									<div class="wt-projectdetail-holder">
										<div class="wt-projectdetail">
											
											<div class="wt-title">
												<h4>Proposal Detail</h4>
											</div>
											{% if not user.is_authenticated %}
											<section class="wt-haslayout wt-dbsectionspace">
												<div class="wt-freelancerholder wt-rcvproposalholder">
													<div class="row">
														<h6>Hiring More Staff </h6>
													<div class="table-responsive">
													<table class="table table-striped table-sm">
														<thead>
														<tr>
					
															<th>Team </th>
															<th>Salary</th>
															<th>AddOn</th>
															<th>Action</th>
					
														</tr>
														</thead>
														<tbody>
					
															<tr>
															<td><a href="javascript:void(0);" class="btn btn-outline-primary btn-sm mt-2"> {{proposal.team.members.count}} Staff{{proposal.team.members.count|pluralize}} Available</a></td>
															<td><button class="btn btn-outline-primary btn-sm mt-2" type="button"> {{base_currency}} {{proposal.salary}}</a></button></td>
															<td>
																<div class="form-group">
																	<select id="select" class="form-control" style="width:auto;">
																		{% if proposal.team.members.count >= 1 %}<option value="1" selected> 1 </option>{% endif %}
																		{% if proposal.team.members.count >= 2 %}<option value="2"> 2 </option>{% endif %}
																		{% if proposal.team.members.count >= 3 %}<option value="3"> 3 </option>{% endif %}
																		{% if proposal.team.members.count >= 4 %}<option value="4"> 4 </option>{% endif %}
																		{% if proposal.team.members.count >= 5 %}<option value="5"> 5 </option>{% endif %}
																	</select>
																</div>
															</td>
															<td><a href="{% url 'account:login' %}" class="btn btn-primary btn-sm mt-2">+ Add</a></td>
															</tr>
														</tbody>
													</table>
												</div>
											</section>
											{% endif %}
											{% if user.is_authenticated and request.user.clients %}
											<section class="wt-haslayout wt-dbsectionspace">
												<div class="wt-freelancerholder wt-rcvproposalholder">
													<div class="row">
														<h6>Hiring More Staff </h6>
													<div class="table-responsive">
													<table class="table table-striped table-sm">
														<thead>
														<tr>
					
															<th>Team </th>
															<th>Salary</th>
															<th>AddOn</th>
															<th>Action</th>
					
														</tr>
														</thead>
														<tbody>
					
															<tr>
															<td><a href="javascript:void(0);" class="btn btn-outline-primary btn-sm mt-2"> {{proposal.team.members.count}} Staff{{proposal.team.members.count|pluralize}} Avail.</a></td>
															<td><button class="btn btn-outline-primary btn-sm mt-2" type="button"> ${{proposal.salary}}</a></button></td>
															<td>
																<div class="form-group">
																	<select id="select" class="form-control" style="width:auto;">
																		{% if proposal.team.members.count >= 1 %}<option value="1" selected> 1 </option>{% endif %}
																		{% if proposal.team.members.count >= 2 %}<option value="2"> 2 </option>{% endif %}
																		{% if proposal.team.members.count >= 3 %}<option value="3"> 3 </option>{% endif %}
																		{% if proposal.team.members.count >= 4 %}<option value="4"> 4 </option>{% endif %}
																		{% if proposal.team.members.count >= 5 %}<option value="5"> 5 </option>{% endif %}
																	</select>                                                                                                                    
																	<button type="button" id="add-box" value="{{proposal.id}}" class="btn btn-info btn-sm mt-2"> + Add </button>
																</div>
															</td>
															<td>
																<a href="{% url 'transactions:hiring_box_summary' %}" class="btn btn-outline-info btn-sm mt-2" target="_blank"><i class="fa fa-window-restore"></i> View</a>
															</td>
															</tr>
														</tbody>
													</table>
												</div>
										</section>
										{% endif %}	
											<div class="wt-description">
												{{proposal.description|safe}}
											</div>
										</div>
										
										<div class="wt-title">
										</div>
										<section id="tabs" class="project-tab">
											<div class="container">
												<div class="row">
													<div class="col-sm-12">
														<nav>
															<div class="nav nav-pills nav-justified" id="nav-tab" role="tablist">
																<a class="nav-item nav-link active" id="nav-home-tab" data-toggle="tab" href="#nav-home" role="tab" aria-controls="nav-home" aria-selected="true">Summary</a>
																<a class="nav-item nav-link" id="nav-profile-tab" data-toggle="tab" href="#nav-profile" role="tab" aria-controls="nav-profile" aria-selected="false">FAQs</a>
																<a class="nav-item nav-link" id="nav-review-tab" data-toggle="tab" href="#nav-review" role="tab" aria-controls="nav-review" aria-selected="false">Review</a>
															</div>
														</nav>
														<div class="tab-content" id="nav-tabContent">
															<div class="tab-pane fade show active" id="nav-home" role="tabpanel" aria-labelledby="nav-home-tab">
																<section class="wt-haslayout wt-dbsectionspace">
																	<div class="col-12 col-sm-12 col-md-12 col-lg-12 float-left">
																		<h4>Analytics</h4>
																		<div class="wt-freelancerholder wt-rcvproposalholder">												
																		{% if not request.user.is_authenticated %}
																			<div class="wt-tabscontenttitle">
																				<div class="text-center">
																					<span style="color:green; font-weight:bold;"><i class="fa fa-exclamation-triangle"></i> 
																						Please login to view the statistics for the proposal. 
																					</span>
																				</div>
																			</div>
																		{% endif %}
																		{% if request.user.is_authenticated %}
																			<div class="wt-tabscontenttitle">
																				<div class="text-left">
																					<span style="color:green; font-weight:bold;"><i class="fa fa-exclamation-triangle"></i> 
																						Info: Same proposal can be bought directly, bought via internal contract, through 1CC and more. 
																					</span>
																				</div>
																			</div>									 
																			<div class="table-responsive">
																			<table class="table">
																			<thead>
																				<tr>
																					<th>Profile</th>
																					<th>Team</th>
																					<th>Author</th>
																					<th>Members</th>
																					<th>Skills</th>
																				</tr>
																			</thead>
																			<body>
																				<tr>
																					<td>Proposal</td>
																					<td>{{proposal.team.title}}</td>
																					<td>@{{proposal.created_by.short_name}}</td>
																					<td>has {{proposal.team.members.count}} Staff{{proposal.team.members.count|pluralize}}</td>
																					<td>{% for skill in proposal.skill.all %} {{skill}}, {% endfor %}</td>
																				</tr>
																				
																				<tr>
																					<th>Sales Report</th>
																					<th>Direct</th>
																					<th>Contract</th>
																					<th>1C-Pro</th>
																					<th>1C-Con</th>
																				</tr>
																			</body>
																			<body>
																				<tr>
																					<td>Total Sales</td>
																					<td>{{sales_count_by_proposal}}</td>
																					<td>{{sales_count_by_contract}}</td>
																					<td>{{oneclick_count_by_proposal}}</td>
																					<td>{{oneclick_count_by_contract}}</td>
																				</tr>
																				
																				<tr>
																					<th>Review Report</th>
																					<th>Direct</th>
																					<th>Contract</th>
																					<th>1C-Pro</th>
																					<th>1C-Con</th>
																				</tr>
																			</body>
																			
																			<body>
																				<tr>
																					<td>Rate</td>
																					<td>{% if proposal_review_avg.proposal_rating_count == 0 %} 0{% else %}{{proposal_review_avg.proposal_average_rating}}{% endif %}/5</td>
																					<td>{% if contract_review_avg.contract_rating_count == 0 %} 0{% else %}{{contract_review_avg.contract_average_rating}}{% endif %}/5</td>
																					<td>{% if oneclick_proposal_review_avg.proposal_rating_count == 0 %} 0{% else %}{{oneclick_proposal_review_avg.proposal_average_rating}}{% endif %}/5</td>
																					<td>{% if oneclick_contract_review_avg.contract_rating_count == 0 %} 0{% else %}{{oneclick_contract_review_avg.contract_average_rating}}{% endif %}/5</td>
																				</tr> 
																				<tr>
																					<td>Feedback {{base_currency_symbol}}{{contract_delta_amount}}</td>
																					<td>{{proposal_review_avg.proposal_rating_count}}</td>
																					<td>{{contract_review_avg.contract_rating_count}}</td>
																					<td>{{oneclick_proposal_review_avg.proposal_rating_count}}</td>
																					<td>{{oneclick_contract_review_avg.contract_rating_count}}</td>
																				</tr>
																			</body>	
																			</table>
																			</div> 
																		</div>
																	</div>
																	<div class="col-12 col-sm-12 col-md-12 col-lg-12 float-left">
																		<p><strong>Foot Notes</strong></p>
																		<div class="wt-freelancerholder wt-rcvproposalholder">
																			<span><i class="ti-check" style='color:green'> 1CC:</i> Means One click checkout transaction(excluding 1CC payment methods)</span><br>
																			<span><i class="ti-check" style='color:green'> Direct:</i> Data for this proposal directly bought(excluding 1CC payment methods)</span><br>
																			<span><i class="ti-check" style='color:green'> Contract:</i> Data for this proposal linked to contract and bought(excluding 1CC payment methods)</span><br>
																			<span><i class="ti-check" style='color:green'> 1C-Pro:</i> Data representing this proposal bought via ICC</span><br>
																			<span><i class="ti-check" style='color:green'> 1C-Con</i> Data representing this proposal linked to contract and bought via ICC</span><br>
																		</div>
																	</div>
																	{% endif %}
																</section>
																<!-- sharethis button begins-->	
																<div class="sharethis-inline-share-buttons"></div>
																<!-- sharethis button ends-->
															</div>
															
															<div class="tab-pane fade" id="nav-profile" role="tabpanel" aria-labelledby="nav-profile-tab">
																<div class="wt-projectdetail">
																	<h4>Proposal FAQs</h4>
																</div>  
																<ul class="wt-accordionhold accordion">
																	{% if proposal.faq_one %}
																	<li>
																		<div class="wt-accordiontitle collapsed" id="headingtwo2" data-toggle="collapse" data-target="#collapsetwo2">
																			<span>{{proposal.faq_one}}</span>
																		</div>
																		<div class="wt-accordiondetails collapse" id="collapsetwo2" aria-labelledby="headingtwo2">
																			<div class="wt-title">
																				<h3>{{proposal.faq_one}}</h3>
																			</div>
																			<div class="wt-description">
																				{{proposal.faq_one_description}}
																			</div>
																		</div>
																	</li>
																	{% endif %}
																	{% if proposal.faq_two %}
																	<li>
																		<div class="wt-accordiontitle collapsed" id="headingthree2" data-toggle="collapse" data-target="#collapsethree2">
																			<span>{{proposal.faq_two}}</span>
																		</div>
																		<div class="wt-accordiondetails collapse" id="collapsethree2" aria-labelledby="headingthree2">
																			<div class="wt-title">
																				<h3>{{proposal.faq_two}}</h3>
																			</div>
																			<div class="wt-description">
																				{{proposal.faq_two_description}}
																			</div>
																		</div>
																	</li>
																	{% endif %}
																	{% if proposal.faq_three %}
																	<li>
																		<div class="wt-accordiontitle collapsed" id="headingthree8" data-toggle="collapse" data-target="#collapsethree8">
																			<span>{{proposal.faq_three}}</span>
																		</div>
																		<div class="wt-accordiondetails collapse" id="collapsethree8" aria-labelledby="headingthree8">
																			<div class="wt-title">
																				<h3>{{proposal.faq_three}}</h3>
																			</div>
																			<div class="wt-description">
																				{{proposal.faq_three_description}}
																			</div>
																		</div>
																	</li>
																	{% endif %}
																</ul>
															</div>
															<div class="tab-pane fade" id="nav-review" role="tabpanel" aria-labelledby="nav-review-tab">
																<ul class="wt-projectliststyle">
																	<div class="wt-title">
																		<h5>Reviews</h5>
																	</div>	
																</ul>
																<div class="wt-clientfeedback">
																{% if not request.user.is_authenticated %}
																<div class="wt-tabscontenttitle">
																	<div class="text-center">
																		<span style="color:green; font-weight:bold;"><i class="fa fa-exclamation-triangle"></i> 
																			Please login to view reviews connected to this proposal. 
																		</span>
																	</div>
																</div>
																{% endif %}
																{% if request.user.is_authenticated %}
																{% if proposal_review_msg|length > 0 %}
																	{% for review_msg in proposal_review_msg %}	
																	<div class="wt-userlistinghold wt-userlistingsingle wt-bgcolor">	
																		<figure class="wt-userlistingimg">
																			<img src="{% if review_msg.resolution.proposal_sale.purchase.client.clients.profile_photo %}{{review_msg.resolution.proposal_sale.purchase.client.clients.profile_photo.url}}{% endif %}" alt="image description">
																		</figure>
																		<div class="wt-userlistingcontent">
																			<div class="wt-contenthead">
																				<div class="wt-title">
																					<a href="javascript:void(0);"><i class="fa fa-check-circle"></i> {{review_msg.resolution.proposal_sale.purchase.client.get_full_name}}</a>
																					<p>{{review_msg.title}}</p>
																				</div>
																				<ul class="wt-userlisting-breadcrumb">
																					<li><span><i class="far fa-calendar"> Date: {{review_msg.created_at|date:"M-d-Y"}}</i></span></li>
																					<li><span><img src="{% if review_msg.resolution.proposal_sale.purchase.client.clients.profile_photo %}{{review_msg.resolution.proposal_sale.purchase.client.country.flag.url}}{% endif %}" alt="img description"> {{review_msg.resolution.proposal_sale.purchase.client.country.name|truncatechars:30}}</span></li>
																					<li><span>{{review_msg.rating}}/5 <i class="fa fa-star fill" style='color:orange'> Review</i></span></li>
																				</ul>
																			</div>
																		</div>
																	</div>
																	<div class="wt-description">
																		<p>“{{review_msg.message|linebreaksbr}}.”</p>
																	</div>
																	{% endfor %}
																{% else %}
																<p class='text-center'><strong style="color:blue;" role="alert">This proposal has no reviews at the moment</strong></p>
																{% endif %}	
																{% endif %}	
																</div>
															</div>
														</div>
													</div>
												</div>
											</div>
										</section>
									</div>
									
									{% if other_proposals|length > 0 %}
									{% if request.user.clients %}
									<div class="wt-proposalsr"></div>
										<div class="wt-dashboardbox wt-proposalsr">
											<div class="wt-dashboardboxcontent wt-hiredfreelance">
												<div class="wt-usersidebaricon">
													<span class="fa fa-cog wt-usersidebardown"></span>
												</div>
												<h4>Other Proposals</h4>
												<aside id="wt-sidebar" class="wt-sidebar wt-usersidebar">
												{% for oth_proposal in other_proposals %}
												<div class="wt-userlistinghold wt-featured">
													<figure class="wt-userlistingimg">
														<img src="{% firstof oth_proposal.thumbnail.url oth_proposal.team.created_by.freelancer.profile_photo.url oth_proposal.created_by.freelancer.profile_photo.url%}" style="height:60px; width:60px" alt="image description" class="img description">
													</figure>
													<div class="wt-proposaldetails">
														<div class="wt-contenthead">
															<div class="wt-title">
																<a href="{% url 'proposals:proposal_detail' oth_proposal.created_by.short_name oth_proposal.slug %}">
																{% if request.user.is_authenticated %} 
																{{proposal.created_by.get_full_name|capfirst}} 
																{% else %} 
																{{proposal.created_by.short_name|capfirst}} 
																{% endif %}
																<span>{{oth_proposal.title|truncatechars:50}}</span></a>
																<a href="{% url 'proposals:proposal_detail' oth_proposal.created_by.short_name oth_proposal.slug %}" class="wt-hiredarrow"><i class="lnr lnr-chevron-right"></i></a>
															</div>
														</div>													
													</div>	
												</div>
												{% endfor %}
											</aside>
											</div>
										</div>
										{% endif %}
										{% endif %}
									{% comment %} </div> {% endcomment %}
								</div>

								<div class="col-xs-12 col-sm-12 col-md-5 col-lg-5 col-xl-4 float-left">
								<aside id="wt-sidebar" class="wt-sidebar">
								<div class="wt-dashboardbox">
									<div class="wt-dashboardboxtitle text-center">
										<h2>About Author</h2>
									</div>
									<div class="wt-dashboardboxcontent wt-hiredfreelance">
										<div class="wt-companysinfo">
											<figure class="wt-companyad">
												<img src="{% firstof proposal.created_by.freelancer.profile_photo.url proposal.created_by.freelancer.banner_photo.url proposal.thumbnail.url %}" style="height:100px;" alt="img description">
											</figure>
											<div class="wt-title"> 
												<a href="javascript:void(0);">
													<i class="fa fa-check-circle"> {% if request.user.is_authenticated %} {{proposal.created_by.get_full_name|capfirst}} {% else %} {{proposal.created_by.short_name|capfirst}} {% endif %}</i>
												</a>
											</div>
											<ul class="wt-postarticlemeta">
												<li>
													<a href="javascript:void(0);">
														<span>Jobs</span>
													</a>
												</li>
												<li>
													<a href="{{profile_view.freelancer_profile_absolute_url}}">
														<span>Profile</span>
													</a>
												</li>
												<li class="wt-following">
													<a href="javascript:void(0);">
														<span>Following</span>
													</a>
												</li>
											</ul>
										</div>
									</div>
									<div class="wt-clicksavearea">
										<a href="{% url 'proposals:proposal_chat_messages' proposal.created_by.short_name proposal.slug %}" class="btn btn-danger justify-content-md-center"><i class="far fa-smile"></i> Author Support</a>
									</div>
								</div>
									
								<div class="wt-proposalsr"></div>
								<div class="wt-dashboardbox text-center">
									<span>Advertisement</span>
									<div class="wt-companyad">
										<figure class="wt-companyadimg">
											<img src="{% firstof proposal.thumbnail.url proposal.created_by.freelancer.banner_photo.url %}" style="height:270px; width:350px;" alt="img description">
										</figure>
									</div>
								</div>

								{% if request.user.is_authenticated %}
								<div class="wt-proposalsr"></div>
									<div class="wt-dashboardbox">
										<div class="wt-dashboardboxtitle">
											<h2>{% if request.user.clients %} Recommended Proposals {% elif request.user.freelancer %} This Team's Proposals {% endif %}</h2>
										</div>
										<div class="wt-dashboardboxcontent wt-hiredfreelance">
											{% for captured_proposal in all_viewed_proposals %}
											<div class="wt-userlistinghold wt-featured">
												<figure class="wt-userlistingimg">
													<img src="{% firstof captured_proposal.thumbnail.url captured_proposal.team.created_by.freelancer.profile_photo.url captured_proposal.created_by.freelancer.profile_photo.url%}" style="height:60px; width:60px" alt="image description" class="img description">
												</figure>
											<div class="wt-proposaldetails">
												<div class="wt-contenthead">
													<div class="wt-title">
														<a href="{% url 'proposals:proposal_detail' captured_proposal.created_by.short_name captured_proposal.slug %}">{{captured_proposal.team|truncatechars:25}}<span>{{captured_proposal.title|truncatechars:25}}</span></a>
														<a href="{% url 'proposals:proposal_detail' captured_proposal.created_by.short_name captured_proposal.slug %}" class="wt-hiredarrow"><i class="lnr lnr-chevron-right"></i></a>
													</div>
												</div>													
											</div>	
											</div>
											{% empty %}
											<p>No recommendation at the moment</p>
											{% endfor %}
										</div>
									</div>
									{% endif %}
									</aside>
								</div>
							</div>
						</div>
					</div>
				</div>
			</main>
		</div>
		<!--Content Wrapper End-->
	</div>

	{% include 'client/partials/one_click_proposal_modal.html' %}

{% endblock content %}

{% block scripts %}
<script>
	$(document).on('click', '#add-box', function (e) {
	  e.preventDefault();
	  $.ajax({
		type: 'POST',
		url: '{% url "transactions:add_to_hiring_box" %}',
		data: {
			proposalid: $('#add-box').val(),
			memberqty: $('#select option:selected').text(),
			csrfmiddlewaretoken: "{{csrf_token}}",
			action: 'post'
		},
		success: function (json) {
			document.getElementById("members-qty").innerHTML = json.member_qty
		},
		error: function (xhr, errmsg, err) {}
	  });
	})
  </script>

  <script>
	$(document).on('click', '#oneClickCheckout', function (e) {
	  e.preventDefault();

	  let displayMessage = document.getElementById('oneClick-message');
	  let displayError = document.getElementById("oneClick-error")
	  $.ajax({
		type: 'POST',
		url: '{% url "client:one_click_proposal_checkout" %}',
		data: {
			proposalId:'{{proposal.id}}',
			csrfmiddlewaretoken: "{{csrf_token}}",
			action: 'oneclick-pay'
		},
		beforeSend:function(){
			$("#oneClickCheckout").attr("disabled", true);
		},
		success: function (json) {
			if(json.errors != ''){
				displayError.innerHTML = json.errors;
				$("#oneClickCheckout").attr("disabled", false);
				return false
			}
			else{
				displayMessage.innerHTML = '';
				displayMessage.innerHTML = json.message;
				$("#oneClickCheckout").attr("disabled", true);
			}
		},
		error: function (xhr, errmsg, err) {
			$("#oneClickCheckout").attr("disabled", false);
		}
	  });
	})
  </script>
	<!-- sharethis script begins-->	
	<script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=61172317d98f630012c48739&product=inline-share-buttons" async="async"></script>	
	<!-- sharethis script ends-->
{% endblock scripts %}




